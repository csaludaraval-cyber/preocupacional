{
  "entities": {
    "Empresa": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Empresa",
      "type": "object",
      "description": "Entidad que representa la información de la empresa.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único de la empresa."
        },
        "razonSocial": {
          "type": "string",
          "description": "Razón social de la empresa."
        },
        "rut": {
          "type": "string",
          "description": "RUT de la empresa."
        },
        "direccion": {
          "type": "string",
          "description": "Dirección de facturación de la empresa."
        }
      },
      "required": [
        "id",
        "razonSocial",
        "rut",
        "direccion"
      ]
    },
    "Solicitante": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Solicitante",
      "type": "object",
      "description": "Entidad que representa la información del solicitante/trabajador.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único del solicitante."
        },
        "nombre": {
          "type": "string",
          "description": "Nombre del solicitante."
        },
        "rut": {
          "type": "string",
          "description": "RUT del solicitante."
        },
        "cargo": {
          "type": "string",
          "description": "Cargo del solicitante."
        },
        "centroDeCostos": {
          "type": "string",
          "description": "Centro de costos del solicitante."
        },
        "mail": {
          "type": "string",
          "description": "Correo electrónico del solicitante.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "nombre",
        "rut",
        "cargo",
        "centroDeCostos",
        "mail"
      ]
    },
    "Examen": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Examen",
      "type": "object",
      "description": "Entidad que representa un examen del catálogo.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único del examen."
        },
        "nombre": {
          "type": "string",
          "description": "Nombre del examen."
        },
        "categoria": {
          "type": "string",
          "description": "Categoría del examen."
        },
        "valor": {
          "type": "number",
          "description": "Valor del examen."
        },
        "unidad": {
          "type": "string",
          "description": "Unidad monetaria del valor del examen (e.g., CLP)."
        },
        "descripcion": {
          "type": "string",
          "description": "Descripción del examen."
        },
        "esBateria": {
          "type": "boolean",
          "description": "Indica si es un examen individual o una batería."
        }
      },
      "required": [
        "id",
        "nombre",
        "categoria",
        "valor",
        "unidad",
        "descripcion",
        "esBateria"
      ]
    },
    "Cotizacion": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Cotizacion",
      "type": "object",
      "description": "Entidad que representa una cotización.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único de la cotización."
        },
        "empresaId": {
          "type": "string",
          "description": "Referencia a la empresa. (Relationship: Empresa 1:N Cotización)"
        },
        "solicitanteId": {
          "type": "string",
          "description": "Referencia al solicitante. (Relationship: Solicitante 1:N Cotización)"
        },
        "fechaCreacion": {
          "type": "string",
          "description": "Fecha de creación de la cotización.",
          "format": "date-time"
        },
        "examenIds": {
          "type": "array",
          "description": "Referencias a los exámenes incluidos en la cotización. (Relationship: Cotizacion N:N Examen)",
          "items": {
            "type": "string"
          }
        },
        "total": {
          "type": "number",
          "description": "Total de la cotización."
        }
      },
      "required": [
        "id",
        "empresaId",
        "solicitanteId",
        "fechaCreacion",
        "examenIds",
        "total"
      ]
    },
    "SolicitudPublica": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SolicitudPublica",
      "description": "Representa una solicitud de exámenes enviada por un cliente desde el formulario público.",
      "type": "object",
      "properties": {
        "empresa": {
          "$ref": "#/entities/Empresa"
        },
        "solicitudes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "trabajador": {
                "$ref": "#/entities/Solicitante"
              },
              "examenes": {
                "type": "array",
                "items": {
                  "$ref": "#/entities/Examen"
                }
              }
            }
          }
        },
        "fechaCreacion": {
          "type": "string",
          "format": "date-time"
        },
        "estado": {
          "type": "string",
          "enum": [
            "pendiente",
            "procesada"
          ]
        }
      }
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "/empresas/{empresaId}": {
      "schema": {
        "$ref": "#/entities/Empresa"
      },
      "description": "Almacena la información de las empresas."
    },
    "/solicitantes/{solicitanteId}": {
      "schema": {
        "$ref": "#/entities/Solicitante"
      },
      "description": "Almacena la información de los solicitantes/trabajadores. Acceso restringido al dueño."
    },
    "/examenes/{examenId}": {
      "schema": {
        "$ref": "#/entities/Examen"
      },
      "description": "Catálogo de exámenes disponibles, gestionado por administradores."
    },
    "/cotizaciones/{cotizacionId}": {
      "schema": {
        "$ref": "#/entities/Cotizacion"
      },
      "description": "Almacena las cotizaciones generadas. Contiene IDs para reglas de seguridad."
    },
    "/roles_admin/{userId}": {
      "description": "Colección para gestionar roles de administrador. La existencia de un documento otorga privilegios."
    },
    "/solicitudes_publicas/{solicitudId}": {
      "schema": {
        "$ref": "#/entities/SolicitudPublica"
      },
      "description": "Almacena las solicitudes de exámenes enviadas desde el formulario público. Cualquiera puede crear, pero solo los administradores pueden leer y gestionar."
    }
  }
}